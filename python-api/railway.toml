# Railway Configuration for Python API
# This file should be in webapp/python-api/ directory

[build]
builder = "NIXPACKS"
# Since we're in python-api folder, requirements.txt is one level up
buildCommand = "pip install -r ../requirements.txt && pip install -r ../requirements-api.txt"
nixpacksPlan = """
[phases.setup]
nixPkgs = ["python311", "gcc"]
"""

[deploy]
# No need for cd since root directory is already python-api
startCommand = "python -m uvicorn api.main:app --host 0.0.0.0 --port $PORT"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

# Force Python detection
[build.nixpacksConfig]
providers = ["python"]

[build.nixpacks]
providers = ["python"]