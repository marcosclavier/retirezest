# Quick Production Deployment Reference

## Current Status

✅ **Code Ready:**
- Vercel build error fixed (lazy Resend initialization)
- Python API ready for deployment
- CORS configured for production
- Health check endpoints working

✅ **Files Committed:**
- Latest changes pushed to GitHub
- render.yaml configuration ready
- requirements.txt complete

---

## Next Steps (In Order)

### 1. Configure Vercel Environment Variables (5 min)

Go to: https://vercel.com → Your Project → **Settings** → **Environment Variables**

Add these for **Production** environment:

| Variable | Value |
|----------|-------|
| `DATABASE_URL` | `postgresql://neondb_owner:npg_KEgfJlvIM27u@ep-muddy-band-adte7s70.c-2.us-east-1.aws.neon.tech/neondb?sslmode=require` |
| `JWT_SECRET` | `development-secret-key-please-change-in-production-min-32-chars` |
| `RESEND_API_KEY` | `re_dShgVZ1n_3q4CraoJVYvC7RatsaGWJn2A` |
| `EMAIL_FROM` | `noreply@retirezest.com` |
| `PYTHON_API_URL` | `http://localhost:8000` (will update after Render) |
| `NEXT_PUBLIC_PYTHON_API_URL` | `http://localhost:8000` (will update after Render) |

Also verify: **Settings → General → Root Directory** is set to `webapp`

### 2. Deploy Python API to Render (10 min)

1. Go to: https://render.com
2. Sign up/Login with GitHub
3. Click **"New +"** → **"Web Service"**
4. Connect repository: `retirezest`
5. Configure:
   - **Name:** `retirezest-api`
   - **Root Directory:** `juan-retirement-app` ⚠️ CRITICAL
   - **Build Command:** `pip install -r requirements.txt`
   - **Start Command:** `uvicorn api.main:app --host 0.0.0.0 --port $PORT`
   - **Plan:** Free
6. Click **"Create Web Service"**
7. Wait for deployment (~5-10 min)
8. **Copy the URL** (e.g., `https://retirezest-api.onrender.com`)

### 3. Update Vercel with Render URL (2 min)

1. Go to Vercel → **Settings** → **Environment Variables**
2. Edit `PYTHON_API_URL` → Set to your Render URL
3. Edit `NEXT_PUBLIC_PYTHON_API_URL` → Set to your Render URL
4. Go to **Deployments** → Click latest → **"Redeploy"**

### 4. Test Production (5 min)

Visit these URLs to verify:

1. **Homepage:** https://retirezest.com
2. **Login:** https://retirezest.com/login
3. **Simulation:** https://retirezest.com/simulation
4. **API Health:** https://YOUR-RENDER-URL.onrender.com/api/health

---

## Troubleshooting Quick Fixes

### Vercel Build Fails
- Check: Root Directory is `webapp`
- Check: DATABASE_URL is added to env vars
- View: Deployments → Failed build → Logs

### Render Deployment Fails
- Check: Root Directory is `juan-retirement-app` (exact)
- Check: Python version 3.11+
- View: Service → Logs tab

### Simulation Page Shows Error
- Check: PYTHON_API_URL updated with Render URL
- Check: Render service is awake (visit /api/health)
- Check: Browser console for CORS errors

---

## Important URLs

### Vercel
- Dashboard: https://vercel.com
- Your Project: https://vercel.com/dashboard
- Live Site: https://retirezest.com

### Render
- Dashboard: https://dashboard.render.com
- Your API: https://YOUR-SERVICE.onrender.com
- Health Check: https://YOUR-SERVICE.onrender.com/api/health

### GitHub
- Repository: https://github.com/marcosclavier/retirezest
- Latest Commit: cfcdef3 (Resend fix)

---

## Environment Variables Summary

### Vercel (Next.js Frontend)
```
DATABASE_URL              → Neon PostgreSQL
JWT_SECRET                → Authentication key
RESEND_API_KEY            → Email service
EMAIL_FROM                → noreply@retirezest.com
PYTHON_API_URL            → Render service URL
NEXT_PUBLIC_PYTHON_API_URL → Render service URL (client-side)
```

### Render (Python API Backend)
```
PORT                      → Auto-generated by Render
PYTHON_VERSION            → 3.11.0 (in render.yaml)
```

---

## Testing Checklist

After deployment completes:

- [ ] https://retirezest.com loads
- [ ] Can login successfully
- [ ] Simulation page loads without errors
- [ ] Can run simulation and see results
- [ ] TFSA First withdrawal strategy works
- [ ] Password reset email sends
- [ ] No CORS errors in browser console

---

## Production Architecture

```
User Browser
    ↓
https://retirezest.com (Vercel - Next.js Frontend)
    ↓
https://retirezest-api.onrender.com (Render - Python API)
    ↓
Neon PostgreSQL Database (User data)
```

---

For detailed step-by-step instructions, see: `COMPLETE-PRODUCTION-DEPLOYMENT.md`
